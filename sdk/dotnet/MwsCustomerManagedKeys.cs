// *** WARNING: this file was generated by pulumi-language-dotnet. ***
// *** Do not edit by hand unless you're certain you know what you are doing! ***

using System;
using System.Collections.Generic;
using System.Collections.Immutable;
using System.Threading.Tasks;
using Pulumi.Serialization;

namespace Pulumi.Databricks
{
    /// <summary>
    /// This resource to configure KMS keys for new workspaces within AWS or GCP. This is to support the following features:
    /// 
    /// * [Customer-managed keys for managed services](https://docs.databricks.com/security/keys/customer-managed-keys-managed-services-aws.html): Encrypt the workspace's managed services data in the control plane, including notebooks, secrets, Databricks SQL queries, and Databricks SQL query history  with a CMK.
    /// * [Customer-managed keys for workspace storage](https://docs.databricks.com/security/keys/customer-managed-keys-storage-aws.html): Encrypt the workspace's root S3 bucket and clusters' EBS volumes with a CMK.
    /// 
    /// &gt; This resource can only be used with an account-level provider!
    /// 
    /// Please follow this complete runnable example with new VPC and new workspace setup. Please pay special attention to the fact that there you have two different instances of a databricks provider - one for deploying workspaces (with `host="https://accounts.cloud.databricks.com/"`) and another for the workspace you've created with databricks.MwsWorkspaces resource. If you want both creation of workspaces &amp; clusters within workspace within the same terraform module (essentially same directory), you should use the provider aliasing feature of Pulumi. We strongly recommend having one Pulumi module for creation of workspace + PAT token and the rest in different modules.
    /// 
    /// ## Example Usage
    /// 
    /// &gt; If you've used the resource before, please add `UseCases = ["MANAGED_SERVICES"]` to keep the previous behaviour.
    /// 
    /// ### Customer-managed key for managed services
    /// 
    /// You must configure this during workspace creation
    /// 
    /// ### For GCP
    /// 
    /// ```csharp
    /// using System.Collections.Generic;
    /// using System.Linq;
    /// using Pulumi;
    /// using Databricks = Pulumi.Databricks;
    /// 
    /// return await Deployment.RunAsync(() =&gt; 
    /// {
    ///     var config = new Config();
    ///     // Account Id that could be found in the top right corner of https://accounts.gcp.databricks.com/
    ///     var databricksAccountId = config.RequireObject&lt;dynamic&gt;("databricksAccountId");
    ///     // Id of a google_kms_crypto_key
    ///     var cmekResourceId = config.RequireObject&lt;dynamic&gt;("cmekResourceId");
    ///     var managedServices = new Databricks.MwsCustomerManagedKeys("managed_services", new()
    ///     {
    ///         AccountId = databricksAccountId,
    ///         GcpKeyInfo = new Databricks.Inputs.MwsCustomerManagedKeysGcpKeyInfoArgs
    ///         {
    ///             KmsKeyId = cmekResourceId,
    ///         },
    ///         UseCases = new[]
    ///         {
    ///             "MANAGED_SERVICES",
    ///         },
    ///     });
    /// 
    /// });
    /// ```
    /// 
    /// ### Customer-managed key for workspace storage
    /// 
    /// ### For GCP
    /// 
    /// ```csharp
    /// using System.Collections.Generic;
    /// using System.Linq;
    /// using Pulumi;
    /// using Databricks = Pulumi.Databricks;
    /// 
    /// return await Deployment.RunAsync(() =&gt; 
    /// {
    ///     var config = new Config();
    ///     // Account Id that could be found in the top right corner of https://accounts.gcp.databricks.com/
    ///     var databricksAccountId = config.RequireObject&lt;dynamic&gt;("databricksAccountId");
    ///     // Id of a google_kms_crypto_key
    ///     var cmekResourceId = config.RequireObject&lt;dynamic&gt;("cmekResourceId");
    ///     var storage = new Databricks.MwsCustomerManagedKeys("storage", new()
    ///     {
    ///         AccountId = databricksAccountId,
    ///         GcpKeyInfo = new Databricks.Inputs.MwsCustomerManagedKeysGcpKeyInfoArgs
    ///         {
    ///             KmsKeyId = cmekResourceId,
    ///         },
    ///         UseCases = new[]
    ///         {
    ///             "STORAGE",
    ///         },
    ///     });
    /// 
    /// });
    /// ```
    /// 
    /// ## Related Resources
    /// 
    /// The following resources are used in the same context:
    /// 
    /// * Provisioning Databricks on AWS guide.
    /// * databricks.MwsCredentials to configure the cross-account role for creation of new workspaces within AWS.
    /// * databricks.MwsLogDelivery to configure delivery of [billable usage logs](https://docs.databricks.com/administration-guide/account-settings/billable-usage-delivery.html) and [audit logs](https://docs.databricks.com/administration-guide/account-settings/audit-logs.html).
    /// * databricks.MwsNetworks to [configure VPC](https://docs.databricks.com/administration-guide/cloud-configurations/aws/customer-managed-vpc.html) &amp; subnets for new workspaces within AWS.
    /// * databricks.MwsStorageConfigurations to configure root bucket new workspaces within AWS.
    /// * databricks.MwsWorkspaces to set up [AWS and GCP workspaces](https://docs.databricks.com/getting-started/overview.html#e2-architecture-1).
    /// </summary>
    [DatabricksResourceType("databricks:index/mwsCustomerManagedKeys:MwsCustomerManagedKeys")]
    public partial class MwsCustomerManagedKeys : global::Pulumi.CustomResource
    {
        /// <summary>
        /// Account Id that could be found in the top right corner of [Accounts Console](https://accounts.cloud.databricks.com/)
        /// </summary>
        [Output("accountId")]
        public Output<string> AccountId { get; private set; } = null!;

        /// <summary>
        /// This field is a block and is documented below. This conflicts with `GcpKeyInfo`
        /// </summary>
        [Output("awsKeyInfo")]
        public Output<Outputs.MwsCustomerManagedKeysAwsKeyInfo?> AwsKeyInfo { get; private set; } = null!;

        /// <summary>
        /// (Integer) Time in epoch milliseconds when the customer key was created.
        /// </summary>
        [Output("creationTime")]
        public Output<int> CreationTime { get; private set; } = null!;

        /// <summary>
        /// (String) ID of the encryption key configuration object.
        /// </summary>
        [Output("customerManagedKeyId")]
        public Output<string> CustomerManagedKeyId { get; private set; } = null!;

        /// <summary>
        /// This field is a block and is documented below. This conflicts with `AwsKeyInfo`
        /// </summary>
        [Output("gcpKeyInfo")]
        public Output<Outputs.MwsCustomerManagedKeysGcpKeyInfo?> GcpKeyInfo { get; private set; } = null!;

        /// <summary>
        /// *(since v0.3.4)* List of use cases for which this key will be used. *If you've used the resource before, please add `UseCases = ["MANAGED_SERVICES"]` to keep the previous behaviour.* Possible values are:
        /// * `MANAGED_SERVICES` - for encryption of the workspace objects (notebooks, secrets) that are stored in the control plane
        /// * `STORAGE` - for encryption of the DBFS Storage &amp; Cluster EBS Volumes
        /// </summary>
        [Output("useCases")]
        public Output<ImmutableArray<string>> UseCases { get; private set; } = null!;


        /// <summary>
        /// Create a MwsCustomerManagedKeys resource with the given unique name, arguments, and options.
        /// </summary>
        ///
        /// <param name="name">The unique name of the resource</param>
        /// <param name="args">The arguments used to populate this resource's properties</param>
        /// <param name="options">A bag of options that control this resource's behavior</param>
        public MwsCustomerManagedKeys(string name, MwsCustomerManagedKeysArgs args, CustomResourceOptions? options = null)
            : base("databricks:index/mwsCustomerManagedKeys:MwsCustomerManagedKeys", name, args ?? new MwsCustomerManagedKeysArgs(), MakeResourceOptions(options, ""))
        {
        }

        private MwsCustomerManagedKeys(string name, Input<string> id, MwsCustomerManagedKeysState? state = null, CustomResourceOptions? options = null)
            : base("databricks:index/mwsCustomerManagedKeys:MwsCustomerManagedKeys", name, state, MakeResourceOptions(options, id))
        {
        }

        private static CustomResourceOptions MakeResourceOptions(CustomResourceOptions? options, Input<string>? id)
        {
            var defaultOptions = new CustomResourceOptions
            {
                Version = Utilities.Version,
            };
            var merged = CustomResourceOptions.Merge(defaultOptions, options);
            // Override the ID if one was specified for consistency with other language SDKs.
            merged.Id = id ?? merged.Id;
            return merged;
        }
        /// <summary>
        /// Get an existing MwsCustomerManagedKeys resource's state with the given name, ID, and optional extra
        /// properties used to qualify the lookup.
        /// </summary>
        ///
        /// <param name="name">The unique name of the resulting resource.</param>
        /// <param name="id">The unique provider ID of the resource to lookup.</param>
        /// <param name="state">Any extra arguments used during the lookup.</param>
        /// <param name="options">A bag of options that control this resource's behavior</param>
        public static MwsCustomerManagedKeys Get(string name, Input<string> id, MwsCustomerManagedKeysState? state = null, CustomResourceOptions? options = null)
        {
            return new MwsCustomerManagedKeys(name, id, state, options);
        }
    }

    public sealed class MwsCustomerManagedKeysArgs : global::Pulumi.ResourceArgs
    {
        /// <summary>
        /// Account Id that could be found in the top right corner of [Accounts Console](https://accounts.cloud.databricks.com/)
        /// </summary>
        [Input("accountId", required: true)]
        public Input<string> AccountId { get; set; } = null!;

        /// <summary>
        /// This field is a block and is documented below. This conflicts with `GcpKeyInfo`
        /// </summary>
        [Input("awsKeyInfo")]
        public Input<Inputs.MwsCustomerManagedKeysAwsKeyInfoArgs>? AwsKeyInfo { get; set; }

        /// <summary>
        /// (Integer) Time in epoch milliseconds when the customer key was created.
        /// </summary>
        [Input("creationTime")]
        public Input<int>? CreationTime { get; set; }

        /// <summary>
        /// (String) ID of the encryption key configuration object.
        /// </summary>
        [Input("customerManagedKeyId")]
        public Input<string>? CustomerManagedKeyId { get; set; }

        /// <summary>
        /// This field is a block and is documented below. This conflicts with `AwsKeyInfo`
        /// </summary>
        [Input("gcpKeyInfo")]
        public Input<Inputs.MwsCustomerManagedKeysGcpKeyInfoArgs>? GcpKeyInfo { get; set; }

        [Input("useCases", required: true)]
        private InputList<string>? _useCases;

        /// <summary>
        /// *(since v0.3.4)* List of use cases for which this key will be used. *If you've used the resource before, please add `UseCases = ["MANAGED_SERVICES"]` to keep the previous behaviour.* Possible values are:
        /// * `MANAGED_SERVICES` - for encryption of the workspace objects (notebooks, secrets) that are stored in the control plane
        /// * `STORAGE` - for encryption of the DBFS Storage &amp; Cluster EBS Volumes
        /// </summary>
        public InputList<string> UseCases
        {
            get => _useCases ?? (_useCases = new InputList<string>());
            set => _useCases = value;
        }

        public MwsCustomerManagedKeysArgs()
        {
        }
        public static new MwsCustomerManagedKeysArgs Empty => new MwsCustomerManagedKeysArgs();
    }

    public sealed class MwsCustomerManagedKeysState : global::Pulumi.ResourceArgs
    {
        /// <summary>
        /// Account Id that could be found in the top right corner of [Accounts Console](https://accounts.cloud.databricks.com/)
        /// </summary>
        [Input("accountId")]
        public Input<string>? AccountId { get; set; }

        /// <summary>
        /// This field is a block and is documented below. This conflicts with `GcpKeyInfo`
        /// </summary>
        [Input("awsKeyInfo")]
        public Input<Inputs.MwsCustomerManagedKeysAwsKeyInfoGetArgs>? AwsKeyInfo { get; set; }

        /// <summary>
        /// (Integer) Time in epoch milliseconds when the customer key was created.
        /// </summary>
        [Input("creationTime")]
        public Input<int>? CreationTime { get; set; }

        /// <summary>
        /// (String) ID of the encryption key configuration object.
        /// </summary>
        [Input("customerManagedKeyId")]
        public Input<string>? CustomerManagedKeyId { get; set; }

        /// <summary>
        /// This field is a block and is documented below. This conflicts with `AwsKeyInfo`
        /// </summary>
        [Input("gcpKeyInfo")]
        public Input<Inputs.MwsCustomerManagedKeysGcpKeyInfoGetArgs>? GcpKeyInfo { get; set; }

        [Input("useCases")]
        private InputList<string>? _useCases;

        /// <summary>
        /// *(since v0.3.4)* List of use cases for which this key will be used. *If you've used the resource before, please add `UseCases = ["MANAGED_SERVICES"]` to keep the previous behaviour.* Possible values are:
        /// * `MANAGED_SERVICES` - for encryption of the workspace objects (notebooks, secrets) that are stored in the control plane
        /// * `STORAGE` - for encryption of the DBFS Storage &amp; Cluster EBS Volumes
        /// </summary>
        public InputList<string> UseCases
        {
            get => _useCases ?? (_useCases = new InputList<string>());
            set => _useCases = value;
        }

        public MwsCustomerManagedKeysState()
        {
        }
        public static new MwsCustomerManagedKeysState Empty => new MwsCustomerManagedKeysState();
    }
}
