// *** WARNING: this file was generated by pulumi-language-dotnet. ***
// *** Do not edit by hand unless you're certain you know what you are doing! ***

using System;
using System.Collections.Generic;
using System.Collections.Immutable;
using System.Threading.Tasks;
using Pulumi.Serialization;

namespace Pulumi.Databricks
{
    /// <summary>
    /// This resource creates [On-Behalf-Of tokens](https://docs.databricks.com/administration-guide/users-groups/service-principals.html#manage-personal-access-tokens-for-a-service-principal) for a databricks.ServicePrincipal in Databricks workspaces on AWS and GCP.  In general it's best to use OAuth authentication using client ID and secret, and use this resource mostly for integrations that doesn't support OAuth.
    /// 
    /// &gt; This resource can only be used with a workspace-level provider!
    /// 
    /// &gt; To create On-Behalf-Of token for Azure Service Principal, configure Pulumi provider to use Azure service principal's client ID and secret, and use `databricks.Token` resource to create a personal access token.
    /// 
    /// ## Example Usage
    /// 
    /// Creating a token for a narrowly-scoped service principal, that would be the only one (besides admins) allowed to use PAT token in this given workspace, keeping your automated deployment highly secure.
    /// 
    /// &gt; A given declaration of `databricks_permissions.token_usage` would OVERWRITE permissions to use PAT tokens from any existing groups with token usage permissions such as the `Users` group. To avoid this, be sure to include any desired groups in additional `AccessControl` blocks in the Pulumi configuration file.
    /// 
    /// ```csharp
    /// using System.Collections.Generic;
    /// using System.Linq;
    /// using Pulumi;
    /// using Databricks = Pulumi.Databricks;
    /// 
    /// return await Deployment.RunAsync(() =&gt; 
    /// {
    ///     var @this = new Databricks.ServicePrincipal("this", new()
    ///     {
    ///         DisplayName = "Automation-only SP",
    ///     });
    /// 
    ///     var tokenUsage = new Databricks.Permissions("token_usage", new()
    ///     {
    ///         Authorization = "tokens",
    ///         AccessControls = new[]
    ///         {
    ///             new Databricks.Inputs.PermissionsAccessControlArgs
    ///             {
    ///                 ServicePrincipalName = @this.ApplicationId,
    ///                 PermissionLevel = "CAN_USE",
    ///             },
    ///         },
    ///     });
    /// 
    ///     var thisOboToken = new Databricks.OboToken("this", new()
    ///     {
    ///         ApplicationId = @this.ApplicationId,
    ///         Comment = @this.DisplayName.Apply(displayName =&gt; $"PAT on behalf of {displayName}"),
    ///         LifetimeSeconds = 3600,
    ///     }, new CustomResourceOptions
    ///     {
    ///         DependsOn =
    ///         {
    ///             tokenUsage,
    ///         },
    ///     });
    /// 
    ///     return new Dictionary&lt;string, object?&gt;
    ///     {
    ///         ["obo"] = thisOboToken.TokenValue,
    ///     };
    /// });
    /// ```
    /// 
    /// Creating a token for a service principal with admin privileges
    /// 
    /// ```csharp
    /// using System.Collections.Generic;
    /// using System.Linq;
    /// using Pulumi;
    /// using Databricks = Pulumi.Databricks;
    /// 
    /// return await Deployment.RunAsync(() =&gt; 
    /// {
    ///     var @this = new Databricks.ServicePrincipal("this", new()
    ///     {
    ///         DisplayName = "Pulumi",
    ///     });
    /// 
    ///     var admins = Databricks.GetGroup.Invoke(new()
    ///     {
    ///         DisplayName = "admins",
    ///     });
    /// 
    ///     var thisGroupMember = new Databricks.GroupMember("this", new()
    ///     {
    ///         GroupId = admins.Apply(getGroupResult =&gt; getGroupResult.Id),
    ///         MemberId = @this.Id,
    ///     });
    /// 
    ///     var thisOboToken = new Databricks.OboToken("this", new()
    ///     {
    ///         ApplicationId = @this.ApplicationId,
    ///         Comment = @this.DisplayName.Apply(displayName =&gt; $"PAT on behalf of {displayName}"),
    ///         LifetimeSeconds = 3600,
    ///     }, new CustomResourceOptions
    ///     {
    ///         DependsOn =
    ///         {
    ///             thisGroupMember,
    ///         },
    ///     });
    /// 
    /// });
    /// ```
    /// 
    /// ## Related Resources
    /// 
    /// The following resources are often used in the same context:
    /// 
    /// * End to end workspace management guide.
    /// * databricks.Group data to retrieve information about databricks.Group members, entitlements and instance profiles.
    /// * databricks.GroupMember to attach users and groups as group members.
    /// * databricks.Permissions to manage [access control](https://docs.databricks.com/security/access-control/index.html) in Databricks workspace.
    /// * databricks.ServicePrincipal to manage [Service Principals](https://docs.databricks.com/administration-guide/users-groups/service-principals.html) that could be added to databricks.Group within workspace.
    /// * databricks.Grants to manage data access in Unity Catalog.
    /// 
    /// ## Import
    /// 
    /// !&gt; Importing this resource is not currently supported.
    /// </summary>
    [DatabricksResourceType("databricks:index/oboToken:OboToken")]
    public partial class OboToken : global::Pulumi.CustomResource
    {
        /// <summary>
        /// Application ID of databricks.ServicePrincipal to create a PAT token for.
        /// </summary>
        [Output("applicationId")]
        public Output<string> ApplicationId { get; private set; } = null!;

        /// <summary>
        /// Comment that describes the purpose of the token.
        /// </summary>
        [Output("comment")]
        public Output<string?> Comment { get; private set; } = null!;

        /// <summary>
        /// The number of seconds before the token expires. Token resource is re-created when it expires. If no lifetime is specified, the token remains valid indefinitely.
        /// </summary>
        [Output("lifetimeSeconds")]
        public Output<int?> LifetimeSeconds { get; private set; } = null!;

        /// <summary>
        /// Configure the provider for management through account provider. This block consists of the following fields:
        /// </summary>
        [Output("providerConfig")]
        public Output<Outputs.OboTokenProviderConfig?> ProviderConfig { get; private set; } = null!;

        /// <summary>
        /// **Sensitive** value of the newly-created token.
        /// </summary>
        [Output("tokenValue")]
        public Output<string> TokenValue { get; private set; } = null!;


        /// <summary>
        /// Create a OboToken resource with the given unique name, arguments, and options.
        /// </summary>
        ///
        /// <param name="name">The unique name of the resource</param>
        /// <param name="args">The arguments used to populate this resource's properties</param>
        /// <param name="options">A bag of options that control this resource's behavior</param>
        public OboToken(string name, OboTokenArgs args, CustomResourceOptions? options = null)
            : base("databricks:index/oboToken:OboToken", name, args ?? new OboTokenArgs(), MakeResourceOptions(options, ""))
        {
        }

        private OboToken(string name, Input<string> id, OboTokenState? state = null, CustomResourceOptions? options = null)
            : base("databricks:index/oboToken:OboToken", name, state, MakeResourceOptions(options, id))
        {
        }

        private static CustomResourceOptions MakeResourceOptions(CustomResourceOptions? options, Input<string>? id)
        {
            var defaultOptions = new CustomResourceOptions
            {
                Version = Utilities.Version,
                AdditionalSecretOutputs =
                {
                    "tokenValue",
                },
            };
            var merged = CustomResourceOptions.Merge(defaultOptions, options);
            // Override the ID if one was specified for consistency with other language SDKs.
            merged.Id = id ?? merged.Id;
            return merged;
        }
        /// <summary>
        /// Get an existing OboToken resource's state with the given name, ID, and optional extra
        /// properties used to qualify the lookup.
        /// </summary>
        ///
        /// <param name="name">The unique name of the resulting resource.</param>
        /// <param name="id">The unique provider ID of the resource to lookup.</param>
        /// <param name="state">Any extra arguments used during the lookup.</param>
        /// <param name="options">A bag of options that control this resource's behavior</param>
        public static OboToken Get(string name, Input<string> id, OboTokenState? state = null, CustomResourceOptions? options = null)
        {
            return new OboToken(name, id, state, options);
        }
    }

    public sealed class OboTokenArgs : global::Pulumi.ResourceArgs
    {
        /// <summary>
        /// Application ID of databricks.ServicePrincipal to create a PAT token for.
        /// </summary>
        [Input("applicationId", required: true)]
        public Input<string> ApplicationId { get; set; } = null!;

        /// <summary>
        /// Comment that describes the purpose of the token.
        /// </summary>
        [Input("comment")]
        public Input<string>? Comment { get; set; }

        /// <summary>
        /// The number of seconds before the token expires. Token resource is re-created when it expires. If no lifetime is specified, the token remains valid indefinitely.
        /// </summary>
        [Input("lifetimeSeconds")]
        public Input<int>? LifetimeSeconds { get; set; }

        /// <summary>
        /// Configure the provider for management through account provider. This block consists of the following fields:
        /// </summary>
        [Input("providerConfig")]
        public Input<Inputs.OboTokenProviderConfigArgs>? ProviderConfig { get; set; }

        public OboTokenArgs()
        {
        }
        public static new OboTokenArgs Empty => new OboTokenArgs();
    }

    public sealed class OboTokenState : global::Pulumi.ResourceArgs
    {
        /// <summary>
        /// Application ID of databricks.ServicePrincipal to create a PAT token for.
        /// </summary>
        [Input("applicationId")]
        public Input<string>? ApplicationId { get; set; }

        /// <summary>
        /// Comment that describes the purpose of the token.
        /// </summary>
        [Input("comment")]
        public Input<string>? Comment { get; set; }

        /// <summary>
        /// The number of seconds before the token expires. Token resource is re-created when it expires. If no lifetime is specified, the token remains valid indefinitely.
        /// </summary>
        [Input("lifetimeSeconds")]
        public Input<int>? LifetimeSeconds { get; set; }

        /// <summary>
        /// Configure the provider for management through account provider. This block consists of the following fields:
        /// </summary>
        [Input("providerConfig")]
        public Input<Inputs.OboTokenProviderConfigGetArgs>? ProviderConfig { get; set; }

        [Input("tokenValue")]
        private Input<string>? _tokenValue;

        /// <summary>
        /// **Sensitive** value of the newly-created token.
        /// </summary>
        public Input<string>? TokenValue
        {
            get => _tokenValue;
            set
            {
                var emptySecret = Output.CreateSecret(0);
                _tokenValue = Output.Tuple<Input<string>?, int>(value, emptySecret).Apply(t => t.Item1);
            }
        }

        public OboTokenState()
        {
        }
        public static new OboTokenState Empty => new OboTokenState();
    }
}
