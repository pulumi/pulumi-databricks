// *** WARNING: this file was generated by pulumi-language-java. ***
// *** Do not edit by hand unless you're certain you know what you are doing! ***

package com.pulumi.databricks;

import com.pulumi.core.Output;
import com.pulumi.core.annotations.Export;
import com.pulumi.core.annotations.ResourceType;
import com.pulumi.core.internal.Codegen;
import com.pulumi.databricks.MwsCustomerManagedKeysArgs;
import com.pulumi.databricks.Utilities;
import com.pulumi.databricks.inputs.MwsCustomerManagedKeysState;
import com.pulumi.databricks.outputs.MwsCustomerManagedKeysAwsKeyInfo;
import com.pulumi.databricks.outputs.MwsCustomerManagedKeysGcpKeyInfo;
import java.lang.Integer;
import java.lang.String;
import java.util.List;
import java.util.Optional;
import javax.annotation.Nullable;

/**
 * This resource to configure KMS keys for new workspaces within AWS or GCP. This is to support the following features:
 * 
 * * [Customer-managed keys for managed services](https://docs.databricks.com/security/keys/customer-managed-keys-managed-services-aws.html): Encrypt the workspace&#39;s managed services data in the control plane, including notebooks, secrets, Databricks SQL queries, and Databricks SQL query history  with a CMK.
 * * [Customer-managed keys for workspace storage](https://docs.databricks.com/security/keys/customer-managed-keys-storage-aws.html): Encrypt the workspace&#39;s root S3 bucket and clusters&#39; EBS volumes with a CMK.
 * 
 * &gt; This resource can only be used with an account-level provider!
 * 
 * Please follow this complete runnable example with new VPC and new workspace setup. Please pay special attention to the fact that there you have two different instances of a databricks provider - one for deploying workspaces (with `host=&#34;https://accounts.cloud.databricks.com/&#34;`) and another for the workspace you&#39;ve created with databricks.MwsWorkspaces resource. If you want both creation of workspaces &amp; clusters within workspace within the same terraform module (essentially same directory), you should use the provider aliasing feature of Pulumi. We strongly recommend having one Pulumi module for creation of workspace + PAT token and the rest in different modules.
 * 
 * ## Example Usage
 * 
 * &gt; If you&#39;ve used the resource before, please add `useCases = [&#34;MANAGED_SERVICES&#34;]` to keep the previous behaviour.
 * 
 * ### Customer-managed key for managed services
 * 
 * You must configure this during workspace creation
 * 
 * ### For GCP
 * 
 * <pre>
 * {@code
 * package generated_program;
 * 
 * import com.pulumi.Context;
 * import com.pulumi.Pulumi;
 * import com.pulumi.core.Output;
 * import com.pulumi.databricks.MwsCustomerManagedKeys;
 * import com.pulumi.databricks.MwsCustomerManagedKeysArgs;
 * import com.pulumi.databricks.inputs.MwsCustomerManagedKeysGcpKeyInfoArgs;
 * import java.util.List;
 * import java.util.ArrayList;
 * import java.util.Map;
 * import java.io.File;
 * import java.nio.file.Files;
 * import java.nio.file.Paths;
 * 
 * public class App {
 *     public static void main(String[] args) {
 *         Pulumi.run(App::stack);
 *     }
 * 
 *     public static void stack(Context ctx) {
 *         final var config = ctx.config();
 *         final var databricksAccountId = config.get("databricksAccountId");
 *         final var cmekResourceId = config.get("cmekResourceId");
 *         var managedServices = new MwsCustomerManagedKeys("managedServices", MwsCustomerManagedKeysArgs.builder()
 *             .accountId(databricksAccountId)
 *             .gcpKeyInfo(MwsCustomerManagedKeysGcpKeyInfoArgs.builder()
 *                 .kmsKeyId(cmekResourceId)
 *                 .build())
 *             .useCases("MANAGED_SERVICES")
 *             .build());
 * 
 *     }
 * }
 * }
 * </pre>
 * 
 * ### Customer-managed key for workspace storage
 * 
 * ### For GCP
 * 
 * <pre>
 * {@code
 * package generated_program;
 * 
 * import com.pulumi.Context;
 * import com.pulumi.Pulumi;
 * import com.pulumi.core.Output;
 * import com.pulumi.databricks.MwsCustomerManagedKeys;
 * import com.pulumi.databricks.MwsCustomerManagedKeysArgs;
 * import com.pulumi.databricks.inputs.MwsCustomerManagedKeysGcpKeyInfoArgs;
 * import java.util.List;
 * import java.util.ArrayList;
 * import java.util.Map;
 * import java.io.File;
 * import java.nio.file.Files;
 * import java.nio.file.Paths;
 * 
 * public class App {
 *     public static void main(String[] args) {
 *         Pulumi.run(App::stack);
 *     }
 * 
 *     public static void stack(Context ctx) {
 *         final var config = ctx.config();
 *         final var databricksAccountId = config.get("databricksAccountId");
 *         final var cmekResourceId = config.get("cmekResourceId");
 *         var storage = new MwsCustomerManagedKeys("storage", MwsCustomerManagedKeysArgs.builder()
 *             .accountId(databricksAccountId)
 *             .gcpKeyInfo(MwsCustomerManagedKeysGcpKeyInfoArgs.builder()
 *                 .kmsKeyId(cmekResourceId)
 *                 .build())
 *             .useCases("STORAGE")
 *             .build());
 * 
 *     }
 * }
 * }
 * </pre>
 * 
 * ## Related Resources
 * 
 * The following resources are used in the same context:
 * 
 * * Provisioning Databricks on AWS guide.
 * * databricks.MwsCredentials to configure the cross-account role for creation of new workspaces within AWS.
 * * databricks.MwsLogDelivery to configure delivery of [billable usage logs](https://docs.databricks.com/administration-guide/account-settings/billable-usage-delivery.html) and [audit logs](https://docs.databricks.com/administration-guide/account-settings/audit-logs.html).
 * * databricks.MwsNetworks to [configure VPC](https://docs.databricks.com/administration-guide/cloud-configurations/aws/customer-managed-vpc.html) &amp; subnets for new workspaces within AWS.
 * * databricks.MwsStorageConfigurations to configure root bucket new workspaces within AWS.
 * * databricks.MwsWorkspaces to set up [AWS and GCP workspaces](https://docs.databricks.com/getting-started/overview.html#e2-architecture-1).
 * 
 */
@ResourceType(type="databricks:index/mwsCustomerManagedKeys:MwsCustomerManagedKeys")
public class MwsCustomerManagedKeys extends com.pulumi.resources.CustomResource {
    /**
     * Account Id that could be found in the top right corner of [Accounts Console](https://accounts.cloud.databricks.com/)
     * 
     */
    @Export(name="accountId", refs={String.class}, tree="[0]")
    private Output<String> accountId;

    /**
     * @return Account Id that could be found in the top right corner of [Accounts Console](https://accounts.cloud.databricks.com/)
     * 
     */
    public Output<String> accountId() {
        return this.accountId;
    }
    /**
     * This field is a block and is documented below. This conflicts with `gcpKeyInfo`
     * 
     */
    @Export(name="awsKeyInfo", refs={MwsCustomerManagedKeysAwsKeyInfo.class}, tree="[0]")
    private Output</* @Nullable */ MwsCustomerManagedKeysAwsKeyInfo> awsKeyInfo;

    /**
     * @return This field is a block and is documented below. This conflicts with `gcpKeyInfo`
     * 
     */
    public Output<Optional<MwsCustomerManagedKeysAwsKeyInfo>> awsKeyInfo() {
        return Codegen.optional(this.awsKeyInfo);
    }
    /**
     * (Integer) Time in epoch milliseconds when the customer key was created.
     * 
     */
    @Export(name="creationTime", refs={Integer.class}, tree="[0]")
    private Output<Integer> creationTime;

    /**
     * @return (Integer) Time in epoch milliseconds when the customer key was created.
     * 
     */
    public Output<Integer> creationTime() {
        return this.creationTime;
    }
    /**
     * (String) ID of the encryption key configuration object.
     * 
     */
    @Export(name="customerManagedKeyId", refs={String.class}, tree="[0]")
    private Output<String> customerManagedKeyId;

    /**
     * @return (String) ID of the encryption key configuration object.
     * 
     */
    public Output<String> customerManagedKeyId() {
        return this.customerManagedKeyId;
    }
    /**
     * This field is a block and is documented below. This conflicts with `awsKeyInfo`
     * 
     */
    @Export(name="gcpKeyInfo", refs={MwsCustomerManagedKeysGcpKeyInfo.class}, tree="[0]")
    private Output</* @Nullable */ MwsCustomerManagedKeysGcpKeyInfo> gcpKeyInfo;

    /**
     * @return This field is a block and is documented below. This conflicts with `awsKeyInfo`
     * 
     */
    public Output<Optional<MwsCustomerManagedKeysGcpKeyInfo>> gcpKeyInfo() {
        return Codegen.optional(this.gcpKeyInfo);
    }
    /**
     * *(since v0.3.4)* List of use cases for which this key will be used. *If you&#39;ve used the resource before, please add `useCases = [&#34;MANAGED_SERVICES&#34;]` to keep the previous behaviour.* Possible values are:
     * * `MANAGED_SERVICES` - for encryption of the workspace objects (notebooks, secrets) that are stored in the control plane
     * * `STORAGE` - for encryption of the DBFS Storage &amp; Cluster EBS Volumes
     * 
     */
    @Export(name="useCases", refs={List.class,String.class}, tree="[0,1]")
    private Output<List<String>> useCases;

    /**
     * @return *(since v0.3.4)* List of use cases for which this key will be used. *If you&#39;ve used the resource before, please add `useCases = [&#34;MANAGED_SERVICES&#34;]` to keep the previous behaviour.* Possible values are:
     * * `MANAGED_SERVICES` - for encryption of the workspace objects (notebooks, secrets) that are stored in the control plane
     * * `STORAGE` - for encryption of the DBFS Storage &amp; Cluster EBS Volumes
     * 
     */
    public Output<List<String>> useCases() {
        return this.useCases;
    }

    /**
     *
     * @param name The _unique_ name of the resulting resource.
     */
    public MwsCustomerManagedKeys(java.lang.String name) {
        this(name, MwsCustomerManagedKeysArgs.Empty);
    }
    /**
     *
     * @param name The _unique_ name of the resulting resource.
     * @param args The arguments to use to populate this resource's properties.
     */
    public MwsCustomerManagedKeys(java.lang.String name, MwsCustomerManagedKeysArgs args) {
        this(name, args, null);
    }
    /**
     *
     * @param name The _unique_ name of the resulting resource.
     * @param args The arguments to use to populate this resource's properties.
     * @param options A bag of options that control this resource's behavior.
     */
    public MwsCustomerManagedKeys(java.lang.String name, MwsCustomerManagedKeysArgs args, @Nullable com.pulumi.resources.CustomResourceOptions options) {
        super("databricks:index/mwsCustomerManagedKeys:MwsCustomerManagedKeys", name, makeArgs(args, options), makeResourceOptions(options, Codegen.empty()), false);
    }

    private MwsCustomerManagedKeys(java.lang.String name, Output<java.lang.String> id, @Nullable MwsCustomerManagedKeysState state, @Nullable com.pulumi.resources.CustomResourceOptions options) {
        super("databricks:index/mwsCustomerManagedKeys:MwsCustomerManagedKeys", name, state, makeResourceOptions(options, id), false);
    }

    private static MwsCustomerManagedKeysArgs makeArgs(MwsCustomerManagedKeysArgs args, @Nullable com.pulumi.resources.CustomResourceOptions options) {
        if (options != null && options.getUrn().isPresent()) {
            return null;
        }
        return args == null ? MwsCustomerManagedKeysArgs.Empty : args;
    }

    private static com.pulumi.resources.CustomResourceOptions makeResourceOptions(@Nullable com.pulumi.resources.CustomResourceOptions options, @Nullable Output<java.lang.String> id) {
        var defaultOptions = com.pulumi.resources.CustomResourceOptions.builder()
            .version(Utilities.getVersion())
            .build();
        return com.pulumi.resources.CustomResourceOptions.merge(defaultOptions, options, id);
    }

    /**
     * Get an existing Host resource's state with the given name, ID, and optional extra
     * properties used to qualify the lookup.
     *
     * @param name The _unique_ name of the resulting resource.
     * @param id The _unique_ provider ID of the resource to lookup.
     * @param state
     * @param options Optional settings to control the behavior of the CustomResource.
     */
    public static MwsCustomerManagedKeys get(java.lang.String name, Output<java.lang.String> id, @Nullable MwsCustomerManagedKeysState state, @Nullable com.pulumi.resources.CustomResourceOptions options) {
        return new MwsCustomerManagedKeys(name, id, state, options);
    }
}
